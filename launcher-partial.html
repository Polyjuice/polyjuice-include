<!--
@deprecated use launcher-root-partial
`launcher-partial` - Custom Element that extends `<template>` (w/ Polymer's TempalteBinding)
by providing predefined template content, which should serve to include partials.
-->
<!-- Import dependencies -->
<!-- <link rel="import" href="/sys/polymer/polymer.html"> -->

<link rel="import" href="/sys/imported-template/imported-template.html">
<link rel="import" href="/sys/juicy-tile-grid/src/juicy-tile-grid.html">
<link rel="import" href="/sys/juicy-tiles-setup-sync/src/juicy-tiles-setup-sync.html">
<!-- <link rel="import" href="/sys/console-log/console-log.html"> -->

<template>
  <!-- FIXME: one-way binding here is temporary workaround for servers not accepting JSON-Patch (tomalec) -->
  <juicy-tiles-setup-sync 
      name="{{Html}}" 
      storedValue="[[_setup]]"
      apiUrl="/launcher/juicytilessetup"></juicy-tiles-setup-sync>
  <juicy-tile-grid 
      id="juicy-tile:{{Html}}" 
      setup="[[_setup | clonedSetup ]]" 
      defaultTileSetup="{
          'heightAuto': true,
          'width': '100%',
          'heightDynamic': true
      }">
    <template is="imported-template" content="{{Html}}"></template>
</juicy-tile-grid>
</template>
<script>
  (function () {
    var templ = (document._currentScript || document.currentScript).ownerDocument.getElementsByTagName("template")[0];

    var LauncherPartialPrototype = Object.create( (HTMLTemplateElement || HTMLElement ).prototype);

    /**
     * Use predefined template content.
     */
    LauncherPartialPrototype.createdCallback = function LPartialCreated(){
      this.innerHTML = templ.innerHTML;
      this.bindingDelegate = new PolymerExpressions();
      this.bindingDelegate.clonedSetup = {

        toDOM: function (json, letter) {
          // debugger
          if(typeof json == "object"){
            return JSON.parse(JSON.stringify(json));
          } else{
            return json;
          }
        },
        toModel: function (json, letter) {
          // debugger
          if(typeof json == "object"){
            return JSON.parse(JSON.stringify(json));
          } else{
            return json;
          }
        }
      }
      // return (HTMLTemplateElement || HTMLElement ).prototype.createdCallback.apply(this, arguments);
    };

    document.registerElement('launcher-partial', {
      prototype: LauncherPartialPrototype,
      extends: "template"
    });   
  })();
</script>